-- 1. Выведите список покупателей (фамилия, имя) старше 50 лет, накупивших в магазине более
-- чем на 100000 долларов. (oe.customers, oe.orders)
-- 
-- select 
--     cus.cust_last_name, 
--     cus.cust_first_name
-- from 
--     oe.customers cus
-- inner join
--     oe.orders ord
--     on cus.customer_id = ord.customer_id
-- where 
--     add_months (cus.date_of_birth, 12*50) < to_date (sysdate)
-- group by
--     cus.cust_last_name, cus.cust_first_name
-- having 
--     sum(ord.order_total) > 100000
-- order by 
--     cus.cust_last_name
--
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 2. Выведите список всех сотрудников (фамилия, имя) и сколько заказов он обработал.
-- (hr.employees, oe.orders)
--
-- select 
--     emp.last_name,
--     emp.first_name,
--     count(  
--         case   
--             when order_id is not null then ord.order_id 
--             else null
--         end   
--     ) as order_count  
-- from 
--     hr.employees emp
-- left join
--     oe.orders ord
--     on emp.employee_id = ord. sales_rep_id
-- group by 
--     emp.last_name, emp.first_name
-- order by 
--     order_count desc
-- -- 1. Выведите список покупателей (фамилия, имя) старше 50 лет, накупивших в магазине более-- 1. Выведите список покупателей (фамилия, имя) старше 50 лет, накупивших в магазине более
-- чем на 100000 долларов. (oe.customers, oe.orders)
-- 
-- select 
--     cus.cust_last_name, 
--     cus.cust_first_name
-- from 
--     oe.customers cus
-- inner join
--     oe.orders ord
--     on cus.customer_id = ord.customer_id
-- where 
--     add_months (cus.date_of_birth, 12*50) < to_date (sysdate)
-- group by
--     cus.cust_last_name, cus.cust_first_name
-- having 
--     sum(ord.order_total) > 100000
-- order by 
--     cus.cust_last_name
--
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 2. Выведите список всех сотрудников (фамилия, имя) и сколько заказов он обработал.
-- (hr.employees, oe.orders)
--
-- select 
--     emp.last_name,
--     emp.first_name,
--     count(  
--         case   
--             when order_id is not null then ord.order_id 
--             else null
--         end   
--     ) as order_count  
-- from 
--     hr.employees emp
-- left join
--     oe.orders ord
--     on emp.employee_id = ord. sales_rep_id
-- group by 
--     emp.last_name, emp.first_name
-- order by 
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 3. Выведите имена покупателей и количество заказов, которые он сделал. (oe.customers,
-- oe.orders)
--
-- select 
--     cus.cust_first_name,
--     count(  
--         case   
--             when order_id is not null then ord.order_id 
--             else null
--         end   
--     ) as order_count      
-- from 
--     oe.customers cus
-- left join
--     oe.orders ord
--     on cus.customer_id = ord.customer_id
-- group by 
--     cus.cust_first_name
-- order by 
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 4. Выведите имена всех покупателей и количество мониторов, которые они купили.
-- (oe.customers, oe.orders, oe.order_items, oe.product_information)
--
-- select 
--     cus.cust_first_name, 
--     count(  
--         case   
--             when inf.category_id = 11 then ord.order_id 
--             else null
--         end   
--     ) as order_count  
-- from   
--     oe.customers cus  
-- left join   
--     oe.orders ord 
--     on cus.customer_id = ord.customer_id 
-- left join 
--     oe.order_items ite 
--     on ord.order_id = ite.order_id 
-- left join 
--     oe.product_information inf 
--     on ite.product_id = inf.product_id 
-- group by 
--     cus.cust_first_name
-- order by
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 5. Выведите все заказы и количество проданных CPU D400 в них. (oe.orders, oe.order_items,
-- oe.product_information)
-- 
-- select  
--     ord.order_id,  
--     sum(  
--         case 
--             when inf.product_name = 'CPU D400' then ite.quantity  
--             else 0  
--         end   
--     ) as item_sum
-- from 
--     oe.orders ord
-- left join
--     oe.order_items ite  
--     on ord.order_id = ite.order_id
-- left join
--     oe.product_information inf  
--     on inf.product_id = ite.product_id
-- group by 
--     ord.order_id  
-- order by 
--     item_sum desc  
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 6. Выведите список (фамилия, имя сотрудника) и их начальников (фамилия, имя).
-- (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 7. Напишите запрос, который покажет имя и фамилию сотрудников, которые получают
-- заработную плату больше своего менеджера. (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 8. Выведите список сотрудников отдела продаж, кто не совершил ни одной продажи в марте
-- 2007 года. (hr.employees, oe.orders)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 9*. Создайте отчет по суммарным месячным продажам фирмы за все 12 месяцев в 2007 году.
-- (oe.orders)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 10*. Добавьте к отчету фамилию продавшего на наибольшую сумму менеджера. (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 11*. Дана таблица ученик – оценка. Выведите количество двоек у учеников, имеющих 10 и
-- более пятерок. За один проход по таблице.
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------


-- чем на 100000 долларов. (oe.customers, oe.orders)
-- 
-- select 
--     cus.cust_last_name, 
--     cus.cust_first_name
-- from 
--     oe.customers cus
-- inner join
--     oe.orders ord
--     on cus.customer_id = ord.customer_id
-- where 
--     add_months (cus.date_of_birth, 12*50) < to_date (sysdate)
-- group by
--     cus.cust_last_name, cus.cust_first_name
-- having 
--     sum(ord.order_total) > 100000
-- order by 
--     cus.cust_last_name
--
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 2. Выведите список всех сотрудников (фамилия, имя) и сколько заказов он обработал.
-- (hr.employees, oe.orders)
--
-- select 
--     emp.last_name,
--     emp.first_name,
--     count(  
--         case   
--             when order_id is not null then ord.order_id 
--             else null
--         end   
--     ) as order_count  
-- from 
--     hr.employees emp
-- left join
--     oe.orders ord
--     on emp.employee_id = ord. sales_rep_id
-- group by 
--     emp.last_name, emp.first_name
-- order by 
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 3. Выведите имена покупателей и количество заказов, которые он сделал. (oe.customers,
-- oe.orders)
--
-- select 
--     cus.cust_first_name,
--     count(  
--         case   
--             when order_id is not null then ord.order_id 
--             else null
--         end   
--     ) as order_count      
-- from 
--     oe.customers cus
-- left join
--     oe.orders ord
--     on cus.customer_id = ord.customer_id
-- group by 
--     cus.cust_first_name
-- order by 
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 4. Выведите имена всех покупателей и количество мониторов, которые они купили.
-- (oe.customers, oe.orders, oe.order_items, oe.product_information)
--
-- select 
--     cus.cust_first_name, 
--     count(  
--         case   
--             when inf.category_id = 11 then ord.order_id 
--             else null
--         end   
--     ) as order_count  
-- from   
--     oe.customers cus  
-- left join   
--     oe.orders ord 
--     on cus.customer_id = ord.customer_id 
-- left join 
--     oe.order_items ite 
--     on ord.order_id = ite.order_id 
-- left join 
--     oe.product_information inf 
--     on ite.product_id = inf.product_id 
-- group by 
--     cus.cust_first_name
-- order by
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 5. Выведите все заказы и количество проданных CPU D400 в них. (oe.orders, oe.order_items,
-- oe.product_information)
-- 
-- select  
--     ord.order_id,  
--     sum(  
--         case 
--             when inf.product_name = 'CPU D400' then ite.quantity  
--             else 0  
--         end   
--     ) as item_sum
-- from 
--     oe.orders ord
-- left join
--     oe.order_items ite  
--     on ord.order_id = ite.order_id
-- left join
--     oe.product_information inf  
--     on inf.product_id = ite.product_id
-- group by 
--     ord.order_id  
-- order by 
--     item_sum desc  
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 6. Выведите список (фамилия, имя сотрудника) и их начальников (фамилия, имя).
-- (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 7. Напишите запрос, который покажет имя и фамилию сотрудников, которые получают
-- заработную плату больше своего менеджера. (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 8. Выведите список сотрудников отдела продаж, кто не совершил ни одной продажи в марте
-- 2007 года. (hr.employees, oe.orders)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 9*. Создайте отчет по суммарным месячным продажам фирмы за все 12 месяцев в 2007 году.
-- (oe.orders)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 10*. Добавьте к отчету фамилию продавшего на наибольшую сумму менеджера. (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 11*. Дана таблица ученик – оценка. Выведите количество двоек у учеников, имеющих 10 и
-- более пятерок. За один проход по таблице.
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------


---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 3. Выведите имена покупателей и количество заказов, которые он сделал. (oe.customers,
-- oe.orders)
--
-- select 
--     cus.cust_first_name,
--     count(  
--         case   
--             when order_id is not null then ord.order_id 
--             else null
--         end   
--     ) as order_count      
-- from 
--     oe.customers cus
-- left join
--     oe.orders ord
--     on cus.customer_id = ord.customer_id
-- group by 
--     cus.cust_first_name
-- order by 
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 4. Выведите имена всех покупателей и количество мониторов, которые они купили.
-- (oe.customers, oe.orders, oe.order_items, oe.product_information)
--
-- select 
--     cus.cust_first_name, 
--     count(  
--         case   
--             when inf.category_id = 11 then ord.order_id 
--             else null
--         end   
--     ) as order_count  
-- from   
--     oe.customers cus  
-- left join   
--     oe.orders ord 
--     on cus.customer_id = ord.customer_id 
-- left join 
--     oe.order_items ite 
--     on ord.order_id = ite.order_id 
-- left join 
--     oe.product_information inf 
--     on ite.product_id = inf.product_id 
-- group by 
--     cus.cust_first_name
-- order by
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 5. Выведите все заказы и количество проданных CPU D400 в них. (oe.orders, oe.order_items,
-- oe.product_information)
-- SELECT  
--     o.ORDER_ID,  
--     sum(  
--         CASE   
--             WHEN pi2.PRODUCT_NAME = 'CPU D400' THEN oi.quantity  
--             ELSE 0  
--         END   
--     ) as sum_  
-- FROM oe.ORDERS o   
-- LEFT JOIN oe.ORDER_ITEMS oi  
--   ON o.ORDER_ID = oi.ORDER_ID   
-- LEFT JOIN oe.PRODUCT_INFORMATION pi2  
--   ON pi2.PRODUCT_ID = oi.PRODUCT_ID   
-- GROUP BY o.ORDER_ID  
-- order by sum_ desc  

-- 6. Выведите список (фамилия, имя сотрудника) и их начальников (фамилия, имя).
-- (hr.employees)
-- 7. Напишите запрос, который покажет имя и фамилию сотрудников, которые получают
-- заработную плату больше своего менеджера. (hr.employees)
-- 8. Выведите список сотрудников отдела продаж, кто не совершил ни одной продажи в марте
-- 2007 года. (hr.employees, oe.orders)
-- 9*. Создайте отчет по суммарным месячным продажам фирмы за все 12 месяцев в 2007 году.
-- (oe.orders)
-- 10*. Добавьте к отчету фамилию продавшего на наибольшую сумму менеджера. (hr.employees)
-- 11*. Дана таблица ученик – оценка. Выведите количество двоек у учеников, имеющих 10 и
-- более пятерок. За один проход по таблице.
-- 1. Выведите список покупателей (фамилия, имя) старше 50 лет, накупивших в магазине более
-- чем на 100000 долларов. (oe.customers, oe.orders)
-- 
-- select 
--     cus.cust_last_name, 
--     cus.cust_first_name
-- from 
--     oe.customers cus
-- inner join
--     oe.orders ord
--     on cus.customer_id = ord.customer_id
-- where 
--     add_months (cus.date_of_birth, 12*50) < to_date (sysdate)
-- group by
--     cus.cust_last_name, cus.cust_first_name
-- having 
--     sum(ord.order_total) > 100000
-- order by 
--     cus.cust_last_name
--
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 2. Выведите список всех сотрудников (фамилия, имя) и сколько заказов он обработал.
-- (hr.employees, oe.orders)
--
-- select 
--     emp.last_name,
--     emp.first_name,
--     count(  
--         case   
--             when order_id is not null then ord.order_id 
--             else null
--         end   
--     ) as order_count  
-- from 
--     hr.employees emp
-- left join
--     oe.orders ord
--     on emp.employee_id = ord. sales_rep_id
-- group by 
--     emp.last_name, emp.first_name
-- order by 
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 3. Выведите имена покупателей и количество заказов, которые он сделал. (oe.customers,
-- oe.orders)
--
-- select 
--     cus.cust_first_name,
--     count(  
--         case   
--             when order_id is not null then ord.order_id 
--             else null
--         end   
--     ) as order_count      
-- from 
--     oe.customers cus
-- left join
--     oe.orders ord
--     on cus.customer_id = ord.customer_id
-- group by 
--     cus.cust_first_name
-- order by 
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
--
-- 4. Выведите имена всех покупателей и количество мониторов, которые они купили.
-- (oe.customers, oe.orders, oe.order_items, oe.product_information)
--
-- select 
--     cus.cust_first_name, 
--     count(  
--         case   
--             when inf.category_id = 11 then ord.order_id 
--             else null
--         end   
--     ) as order_count  
-- from   
--     oe.customers cus  
-- left join   
--     oe.orders ord 
--     on cus.customer_id = ord.customer_id 
-- left join 
--     oe.order_items ite 
--     on ord.order_id = ite.order_id 
-- left join 
--     oe.product_information inf 
--     on ite.product_id = inf.product_id 
-- group by 
--     cus.cust_first_name
-- order by
--     order_count desc
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 5. Выведите все заказы и количество проданных CPU D400 в них. (oe.orders, oe.order_items,
-- oe.product_information)
-- 
-- select  
--     ord.order_id,  
--     sum(  
--         case 
--             when inf.product_name = 'CPU D400' then ite.quantity  
--             else 0  
--         end   
--     ) as item_sum
-- from 
--     oe.orders ord
-- left join
--     oe.order_items ite  
--     on ord.order_id = ite.order_id
-- left join
--     oe.product_information inf  
--     on inf.product_id = ite.product_id
-- group by 
--     ord.order_id  
-- order by 
--     item_sum desc  
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 6. Выведите список (фамилия, имя сотрудника) и их начальников (фамилия, имя).
-- (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 7. Напишите запрос, который покажет имя и фамилию сотрудников, которые получают
-- заработную плату больше своего менеджера. (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 8. Выведите список сотрудников отдела продаж, кто не совершил ни одной продажи в марте
-- 2007 года. (hr.employees, oe.orders)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 9*. Создайте отчет по суммарным месячным продажам фирмы за все 12 месяцев в 2007 году.
-- (oe.orders)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 10*. Добавьте к отчету фамилию продавшего на наибольшую сумму менеджера. (hr.employees)
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------
-- 
-- 11*. Дана таблица ученик – оценка. Выведите количество двоек у учеников, имеющих 10 и
-- более пятерок. За один проход по таблице.
-- 
---------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------

