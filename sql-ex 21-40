Схема БД состоит из четырех таблиц:
Product(maker, model, type)
PC(code, model, speed, ram, hd, cd, price)
Laptop(code, model, speed, ram, hd, price, screen)
Printer(code, model, color, type, price)
Таблица Product представляет производителя (maker), номер модели (model) и тип ('PC' - ПК, 'Laptop' - ПК-блокнот или 'Printer' - принтер). Предполагается, что номера моделей в таблице Product уникальны для всех производителей и типов продуктов. В таблице PC для каждого ПК, однозначно определяемого уникальным кодом – code, указаны модель – model (внешний ключ к таблице Product), скорость - speed (процессора в мегагерцах), объем памяти - ram (в мегабайтах), размер диска - hd (в гигабайтах), скорость считывающего устройства - cd (например, '4x') и цена - price. Таблица Laptop аналогична таблице РС за исключением того, что вместо скорости CD содержит размер экрана -screen (в дюймах). В таблице Printer для каждой модели принтера указывается, является ли он цветным - color ('y', если цветной), тип принтера - type (лазерный – 'Laser', струйный – 'Jet' или матричный – 'Matrix') и цена - price.

21 Найдите максимальную цену ПК, выпускаемых каждым производителем, у которого есть модели в таблице PC. Вывести: maker, максимальная цена.
Select pr.maker as maker, max(pc.price) as max_price
from product pr
inner join pc pc on pr.model = pc.model
group by pr.maker
 
22 Для каждого значения скорости ПК, превышающего 600 МГц, определите среднюю цену ПК с такой же скоростью. Вывести: speed, средняя цена.
Select speed, avg(price) as avg_price
from pc
where speed > 600
group by speed
 
 23 Найдите производителей, которые производили бы как ПК со скоростью не менее 750 МГц, так и ПК-блокноты со скоростью не менее 750 МГц. Вывести: Maker
Select maker
from product pr
inner join pc pc on pr.model = pc.model
where pc.speed >= 750
intersect
Select maker from product pr
inner join laptop la on pr.model = la.model
where la.speed >= 750
 
24 Перечислите номера моделей любых типов, имеющих самую высокую цену по всей имеющейся в базе данных продукции.
with max_price as (
 select model, price from pc where price in (select max(price) from pc)
 union all
 select model, price from laptop where price in (select max(price) from laptop)
 union all
 select model, price from printer where price in (select max(price) from printer)
)
select distinct model from max_price where price in (select max(price) from max_price)
 
25 Найдите производителей принтеров, которые производят ПК с наименьшим объемом RAM и с самым быстрым процессором среди всех ПК, имеющих наименьший объем RAM. Вывести: Maker
Select distinct maker from product pr 
inner join pc on pr.model = pc.model
where maker in (select maker from product where type = 'Printer')
and ram in (select min(ram) from pc)
and speed in (select max(speed) from pc where ram in (select min(ram) from pc))

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
